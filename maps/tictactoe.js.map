{"version":3,"sources":["tictactoe.coffee"],"names":[],"mappings":"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","file":"tictactoe.js","sourceRoot":"/source/","sourcesContent":["require ['jquery', '3D', 'GameLogic', 'CellStates', 'GameState', 'GameStates'], ($, Board3D, GameLogic, CellStates, GameState, GameStates) ->\n  $canvas = $ 'canvas'\n\n  setCell = (cell, state) ->\n    Board3D.setCellState cell, state\n\n  getCell = (cell) ->\n    Board3D.getCellState cell\n\n  previousPossible = null\n  showPossibleMoves = (e) ->\n    if GameStates.READY_TO_RESET not in GameState.get()\n      clearPossibleMove()\n\n      possibleMove = Board3D.getMove e\n\n      if not GameLogic.isValidMove(possibleMove) or getCell(possibleMove) is CellStates.TENTATIVE_MOVE\n        possibleMove = null\n\n      if possibleMove?\n        clearTentativeMove()\n        setCell possibleMove, CellStates.POSSIBLE_MOVE\n        GameState.set GameStates.POSSIBLE_MOVE\n      previousPossible = possibleMove\n\n  clearPossibleMove = ->\n    if previousPossible?\n      setCell previousPossible, CellStates.DEFAULT\n      previousPossible = null\n      GameState.unset GameStates.POSSIBLE_MOVE\n\n  selectCell = (e) ->\n    if GameStates.READY_TO_RESET not in GameState.get()\n      playerMove = Board3D.getMove e\n      if GameLogic.isValidMove playerMove\n        if getCell(playerMove) is CellStates.TENTATIVE_MOVE\n          makeMove playerMove\n        else\n          tentativeMove playerMove\n\n  makeMove = (playerMove) ->\n    lastComputerMove = GameLogic.getLastComputerMove()\n    if lastComputerMove\n      setCell lastComputerMove, CellStates.COMPUTER_MOVE\n\n    clearTentativeMove()\n    playerLine = GameLogic.makeMove playerMove\n    setCell playerMove, CellStates.PLAYER_MOVE\n    GameState.unset GameStates.TENTATIVE_MOVE\n\n    setTimeout (->\n      computerLine = getComputerMove()\n      checkPotentialWin GameLogic.processState playerLine, computerLine\n    ), 500\n\n  getComputerMove = ->\n    [computerMove, computerLine] = GameLogic.makeComputerMove()\n    setCell computerMove, CellStates.COMPUTER_LAST_MOVE\n    computerLine\n\n  previousTentative = null\n  tentativeMove = (tentativeMove) ->\n    clearTentativeMove()\n    clearPossibleMove()\n\n    setCell tentativeMove, CellStates.TENTATIVE_MOVE\n    GameState.set GameStates.TENTATIVE_MOVE\n    previousTentative = tentativeMove\n\n  clearTentativeMove = ->\n    if previousTentative\n      setCell previousTentative, CellStates.DEFAULT\n      previousTentative = null\n      GameState.unset GameStates.TENTATIVE_MOVE\n\n  checkPotentialWin = (line) ->\n    showWin line if line?\n\n  showWin = (line) ->\n    for cell in line\n      setCell cell, CellStates.WIN\n\n  $ ->\n    $canvas.on 'mousemove', showPossibleMoves\n    $canvas.on 'click', selectCell\n    GameState.set GameStates.HELP\n    if Board3D.noWebGL\n      GameState.set GamesStates.NO_WEBGL\n\n    $('#Help').on 'click', ->\n      GameState.unset GameStates.HELP\n\n    $('#EndGame').on 'click', ->\n      GameState.unset GameStates.END_GAME\n      GameState.set GameStates.READY_TO_RESET\n\n    $('#ResetView').on 'click', Board3D.resetView\n\n    $('#ResetGame').on 'click', ->\n      GameLogic.gameReset()\n      Board3D.resetBoard()\n\n    $('#IncreaseExplode').on 'click', Board3D.increaseExplode\n    $('#DecreaseExplode').on 'click', Board3D.decreaseExplode\n    $('#IncreaseZoom').on 'click', Board3D.increaseZoom\n    $('#DecreaseZoom').on 'click', Board3D.decreaseZoom\n"]}